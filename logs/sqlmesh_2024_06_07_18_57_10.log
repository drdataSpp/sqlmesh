2024-06-07 18:57:10,066 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:299)
2024-06-07 18:57:10,941 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:301)
2024-06-07 18:57:10,957 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:295)
2024-06-07 18:57:10,995 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0001_init.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0002_remove_identify.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0003_move_batch_size.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0004_environmnent_add_finalized_at.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0005_create_seed_table.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0006_change_seed_hash.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0007_env_table_info_to_kind.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0008_create_intervals_table.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0009_remove_pre_post_hooks.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0010_seed_hash_batch_size.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0011_add_model_kind_name.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0012_update_jinja_expressions.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0013_serde_using_model_dialects.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0014_fix_dev_intervals.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0015_environment_add_promoted_snapshot_ids.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0016_fix_windows_path.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0017_fix_windows_seed_path.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0018_rename_snapshot_model_to_node.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0019_add_env_suffix_target.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0020_remove_redundant_attributes_from_dbt_models.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0021_fix_table_properties.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,025 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0022_move_project_to_model.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0023_fix_added_models_with_forward_only_parents.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0024_replace_model_kind_name_enum_with_value.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0025_fix_intervals_and_missing_change_category.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0026_remove_dialect_from_seed.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0027_minute_interval_to_five.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,033 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0028_add_plan_dags_table.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,039 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0029_generate_schema_types_using_dialect.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,039 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0030_update_unrestorable_snapshots.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,039 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0031_remove_dbt_target_fields.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0032_add_sqlmesh_version.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0033_mysql_fix_blob_text_type.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0034_add_default_catalog.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0035_add_catalog_name_override.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0036_delete_plan_dags_bug_fix.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,041 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0037_remove_dbt_is_incremental_macro.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0038_add_expiration_ts_to_snapshot.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0039_include_environment_in_plan_dag_spec.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0040_add_previous_finalized_snapshots.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0041_remove_hash_raw_query_attribute.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0042_trim_indirect_versions.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0044_quote_identifiers_in_model_attributes.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0045_move_gateway_variable' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0045_move_gateway_variable.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0046_add_batch_concurrency' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0046_add_batch_concurrency.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0047_change_scd_string_to_column' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0047_change_scd_string_to_column.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0048_drop_indirect_versions' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0048_drop_indirect_versions.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,047 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0049_replace_identifier_with_version_in_seeds_table' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0049_replace_identifier_with_version_in_seeds_table.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,057 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0050_drop_seeds_table' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0050_drop_seeds_table.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,063 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0051_rename_column_descriptions' from 'C:\\Users\\soory\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\sqlmesh\\migrations\\v0051_rename_column_descriptions.py'> (engine_adapter.py:1004)
2024-06-07 18:57:11,063 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Fetching environments (engine_adapter.py:1010)
2024-06-07 18:57:11,063 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Migrating snapshot rows... (engine_adapter.py:1027)
2024-06-07 18:57:11,063 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - No changes to snapshots detected (engine_adapter.py:1020)
2024-06-07 18:58:26,346 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema DB.sqlmesh__SQLMESH_EXAMPLE (evaluator.py:266)
2024-06-07 18:58:26,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-06-07 18:58:26,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: USE "DB" (base.py:1834)
2024-06-07 18:58:26,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-06-07 18:58:26,362 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE (table_catalog = 'DB' AND table_schema = 'sqlmesh__SQLMESH_EXAMPLE') AND table_name IN ('SQLMESH_EXAMPLE__SEED_MODEL__3243603655', 'SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207__temp', 'SQLMESH_EXAMPLE__SEED_MODEL__3243603655__temp', 'SQLMESH_EXAMPLE__FULL_MODEL__3112620120__temp', 'SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207', 'SQLMESH_EXAMPLE__FULL_MODEL__3112620120') (base.py:1834)
2024-06-07 18:58:26,377 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: USE "db" (base.py:1834)
2024-06-07 18:58:26,377 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'DB.sqlmesh__SQLMESH_EXAMPLE' (evaluator.py:850)
2024-06-07 18:58:26,377 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE" (base.py:1834)
2024-06-07 18:58:26,434 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__SEED_MODEL__3243603655__temp' (evaluator.py:1160)
2024-06-07 18:58:26,441 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655__temp" ("ID" INT, "ITEM_ID" INT, "EVENT_DATE" DATE) (base.py:1834)
2024-06-07 18:58:26,441 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__SEED_MODEL__3243603655' (evaluator.py:1160)
2024-06-07 18:58:26,441 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655" ("ID" INT, "ITEM_ID" INT, "EVENT_DATE" DATE) (base.py:1834)
2024-06-07 18:58:26,472 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655" AS SELECT "ID", "ITEM_ID", "EVENT_DATE" FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."__temp_SQLMESH_EXAMPLE__SEED_MODEL__3243603655_mov04sjn" (base.py:1834)
2024-06-07 18:58:26,472 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."__temp_SQLMESH_EXAMPLE__SEED_MODEL__3243603655_mov04sjn" (base.py:1834)
2024-06-07 18:58:26,488 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207__temp' (evaluator.py:1160)
2024-06-07 18:58:26,488 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207__temp" ("ID" INT, "ITEM_ID" INT, "EVENT_DATE" DATE) (base.py:1834)
2024-06-07 18:58:26,503 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:1180)
2024-06-07 18:58:26,503 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "SEED_MODEL"."ID" AS "ID", "SEED_MODEL"."ITEM_ID" AS "ITEM_ID", "SEED_MODEL"."EVENT_DATE" AS "EVENT_DATE" FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655" AS "SEED_MODEL" WHERE ("SEED_MODEL"."EVENT_DATE" <= CAST('1970-01-01' AS DATE) AND "SEED_MODEL"."EVENT_DATE" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:1834)
2024-06-07 18:58:26,525 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207' (evaluator.py:1160)
2024-06-07 18:58:26,525 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" ("ID" INT, "ITEM_ID" INT, "EVENT_DATE" DATE) (base.py:1834)
2024-06-07 18:58:26,535 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__FULL_MODEL__3112620120__temp' (evaluator.py:1160)
2024-06-07 18:58:26,535 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120__temp" ("ITEM_ID" INT, "NUM_ORDERS" BIGINT) (base.py:1834)
2024-06-07 18:58:26,551 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.full_model' (evaluator.py:1180)
2024-06-07 18:58:26,551 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "INCREMENTAL_MODEL"."ITEM_ID" AS "ITEM_ID", COUNT(DISTINCT "INCREMENTAL_MODEL"."ID") AS "NUM_ORDERS" FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" AS "INCREMENTAL_MODEL" WHERE FALSE GROUP BY "INCREMENTAL_MODEL"."ITEM_ID" LIMIT 0 (base.py:1834)
2024-06-07 18:58:26,551 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__FULL_MODEL__3112620120' (evaluator.py:1160)
2024-06-07 18:58:26,566 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120" ("ITEM_ID" INT, "NUM_ORDERS" BIGINT) (base.py:1834)
2024-06-07 18:58:26,645 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1717632000000, 1717718400000) for snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."SEED_MODEL": 644935166> (engine_adapter.py:600)
2024-06-07 18:58:26,676 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."INCREMENTAL_MODEL": 4131460321> (evaluator.py:480)
2024-06-07 18:58:26,692 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-06-07 00:00:00+00:00) into DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207' (evaluator.py:505)
2024-06-07 18:58:26,692 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" WHERE "EVENT_DATE" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-06-06' AS DATE) (base.py:1834)
2024-06-07 18:58:26,692 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" ("ID", "ITEM_ID", "EVENT_DATE") SELECT "ID", "ITEM_ID", "EVENT_DATE" FROM (SELECT "SEED_MODEL"."ID" AS "ID", "SEED_MODEL"."ITEM_ID" AS "ITEM_ID", "SEED_MODEL"."EVENT_DATE" AS "EVENT_DATE" FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655" AS "SEED_MODEL" WHERE "SEED_MODEL"."EVENT_DATE" <= CAST('2024-06-06' AS DATE) AND "SEED_MODEL"."EVENT_DATE" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "EVENT_DATE" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-06-06' AS DATE) (base.py:1834)
2024-06-07 18:58:26,707 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1717718400000) for snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."INCREMENTAL_MODEL": 4131460321> (engine_adapter.py:600)
2024-06-07 18:58:26,739 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."FULL_MODEL": 1507659090> (evaluator.py:480)
2024-06-07 18:58:26,755 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-06-07 00:00:00+00:00) into DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__FULL_MODEL__3112620120' (evaluator.py:505)
2024-06-07 18:58:26,755 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120" AS SELECT "INCREMENTAL_MODEL"."ITEM_ID" AS "ITEM_ID", COUNT(DISTINCT "INCREMENTAL_MODEL"."ID") AS "NUM_ORDERS" FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" AS "INCREMENTAL_MODEL" GROUP BY "INCREMENTAL_MODEL"."ITEM_ID" (base.py:1834)
2024-06-07 18:58:26,834 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."FULL_MODEL": 1507659090> (evaluator.py:400)
2024-06-07 18:58:26,834 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120" (base.py:1834)
2024-06-07 18:58:26,849 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120" AS "SQLMESH_EXAMPLE__FULL_MODEL__3112620120") AS "_Q_0" WHERE "ITEM_ID" < 0) AS "audit" (base.py:1834)
2024-06-07 18:58:26,849 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1717718400000) for snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."FULL_MODEL": 1507659090> (engine_adapter.py:600)
2024-06-07 18:58:26,896 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:119)
2024-06-07 18:58:26,959 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."FULL_MODEL": 1507659090> (common.py:224)
2024-06-07 18:58:26,959 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."INCREMENTAL_MODEL": 4131460321> (common.py:224)
2024-06-07 18:58:26,975 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"DB"."SQLMESH_EXAMPLE"."SEED_MODEL": 644935166> (common.py:224)
2024-06-07 18:58:26,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'DB.SQLMESH_EXAMPLE' (evaluator.py:850)
2024-06-07 18:58:26,990 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "DB"."SQLMESH_EXAMPLE" (base.py:1834)
2024-06-07 18:58:26,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'DB.SQLMESH_EXAMPLE.SEED_MODEL' to point at table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__SEED_MODEL__3243603655' (evaluator.py:1116)
2024-06-07 18:58:26,990 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "DB"."SQLMESH_EXAMPLE"."SEED_MODEL" AS SELECT * FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__SEED_MODEL__3243603655" (base.py:1834)
2024-06-07 18:58:27,006 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'DB.SQLMESH_EXAMPLE.INCREMENTAL_MODEL' to point at table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207' (evaluator.py:1116)
2024-06-07 18:58:27,006 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "DB"."SQLMESH_EXAMPLE"."INCREMENTAL_MODEL" AS SELECT * FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__INCREMENTAL_MODEL__2620674207" (base.py:1834)
2024-06-07 18:58:27,006 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'DB.SQLMESH_EXAMPLE.FULL_MODEL' to point at table 'DB.sqlmesh__SQLMESH_EXAMPLE.SQLMESH_EXAMPLE__FULL_MODEL__3112620120' (evaluator.py:1116)
2024-06-07 18:58:27,006 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "DB"."SQLMESH_EXAMPLE"."FULL_MODEL" AS SELECT * FROM "DB"."sqlmesh__SQLMESH_EXAMPLE"."SQLMESH_EXAMPLE__FULL_MODEL__3112620120" (base.py:1834)
2024-06-07 18:58:27,038 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'prod' (common.py:197)
2024-06-07 18:58:27,163 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
